# 使用R语言进行方差分析(ANOVA)与邓肯多重比较(Duncan's Test)的自动化脚本

这是一个使用R语言编写的自动化脚本，用于对实验数据进行显著性分析。脚本会自动执行单因素方差分析（One-way ANOVA），并在结果显著时，接着使用邓肯新多重极差法（Duncan's New Multiple Range Test）进行事后检验，最终生成带有显著性字母标记的结果并保存为Excel文件。

## ✨ 功能特性

- **自动化分析**: 只需准备好数据，一键运行即可完成全部分析流程。
- **邓肯检验**: 采用农学、生物学等领域常用的邓肯检验进行多重比较。
- **清晰的结果**: 自动根据均值从大到小排序，并标记 `a`, `b`, `c` 等显著性字母。
- **Excel输出**: 将原始数据与显著性标记合并，输出到新的Excel文件中，方便直接用于报告或论文。
- **环境友好**: 脚本会自动检查并安装所需的R包，无需手动干预。

## ⚙️ 先决条件

1.  **安装R**: 请从 [R官方网站](https://cran.r-project.org/) 下载并安装。
2.  **安装RStudio (推荐)**: 从 [RStudio官网](https://posit.co/download/rstudio-desktop/) 下载并安装免费桌面版。

## 🚀 如何使用

1.  **下载项目**: 将本仓库的所有文件下载到您电脑的同一个文件夹中。
2.  **准备数据**:
    -   准备一个名为 `data.xlsx` 的Excel文件。
    -   将文件放置在与 `analysis.R` 相同的目录下。
    -   数据格式要求：
        -   **每一列代表一个独立的组/处理**。
        -   **每一行代表该组的重复测量值**。
        -   **不要包含任何表头或行名**，数据从A1单元格开始。

    *示例 `data.xlsx` 格式:*
    | | A | B | C |
    | :--- | :--- | :--- | :--- |
    | **1** | 0.0142 | 0.0130 | 0.0139 |
    | **2** | 0.0136 | 0.0126 | 0.0146 |
    | **3** | 0.0133 | 0.0127 | 0.0144 |

3.  **运行脚本**:
    -   **方法一 (RStudio)**: 用RStudio打开 `analysis.R` 文件，然后点击右上角的 "Source" 按钮。
    -   **方法二 (命令行)**: 打开命令提示符(CMD)或PowerShell，进入项目所在目录，运行命令 `Rscript analysis.R`。

## 📊 输出结果

脚本运行成功后，将在同一目录下生成一个名为 `data_with_significance.xlsx` 的文件。文件内容如下：

| | 1 | 2 | 3 |
| :--- | :--- | :--- | :--- |
| **1** | 0.0142 | 0.0130 | 0.0139 |
| **2** | 0.0136 | 0.0126 | 0.0146 |
| **3** | 0.0133 | 0.0127 | 0.0144 |
| **Significance** | c | d | c |

其中，`Significance` 行的字母表示各组间的差异显著性：**拥有不同字母的组之间存在显著差异（p < 0.05），而拥有相同字母的组之间无显著差异。**

## 📄 许可协议

本项目采用 [MIT License](LICENSE) 开源许可。
